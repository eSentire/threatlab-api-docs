<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="./img/favicon.ico">

	<title>ThreatLab API Docs</title>

        <link href="./css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="./css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="./css/highlight.css">
        <link href="./css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href=".">ThreatLab API Docs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="active">
                    <a href=".">Home</a>
                </li>
            
            
            
                <li >
                    <a href="clients/">Clients</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li class="disabled">
                    <a rel="next" >
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="clients/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#about">About</a></li>
        
    
        <li class="main "><a href="#pagination">Pagination</a></li>
        
    
        <li class="main "><a href="#apis">APIs</a></li>
        
            <li><a href="#pcap-upload">PCAP Upload</a></li>
        
            <li><a href="#pcap-status">PCAP Status</a></li>
        
            <li><a href="#pcap-detail">PCAP Detail</a></li>
        
            <li><a href="#pcap-alerts">PCAP Alerts</a></li>
        
            <li><a href="#pcap-errors">PCAP Errors</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="about">About</h1>
<p><a href="http://www.threatlab.io">ThreatLab</a> is a PCAP analysis tool that uses <a href="https://www.snort.org">Snort</a> and <a href="http://suricata-ids.org/">Suricata</a> to scan network packet captures.<br/>
<a href="http://www.emergingthreats.net/open-source/etopen-ruleset">EmergingThreats</a> rules are used for generating alerts.</p>
<h1 id="pagination">Pagination</h1>
<p>ThreatLab API uses "Limit-Offset" pagination.
The client includes both a "limit" and an "offset" query parameter. 
The limit indicates the maximum number of items to return. The default limit size is 10. 
The offset indicates the starting position of the query in relation to the complete set of unpaginated items.</p>
<p>Request example:</p>
<pre><code class="curl">GET http://www.threatlab.io/api/pcap/v1/3dbcaa40-cd9b-4fdf-87ec-8cf226e582ff/alerts/?limit=5&amp;offset=5
</code></pre>

<p>Response:</p>
<pre><code class="json">{
    &quot;count&quot;: 10,
    &quot;next&quot;: null,
    &quot;previous&quot;: &quot;http://www.threatlab.io/api/pcap/v1/3dbcaa40-cd9b-4fdf-87ec-8cf226e582ff/alerts/?limit=5&quot;,
    &quot;results&quot;: [
        ...
    ]
}
</code></pre>

<h1 id="apis">APIs</h1>
<blockquote>
<p>You can interact and test the APIs in your browser:</p>
<p><a href="http://www.threatlab.io/api/console/">http://www.threatlab.io/api/console/</a></p>
</blockquote>
<h2 id="pcap-upload">PCAP Upload</h2>
<p>Upload PCAP file for analysis</p>
<p><code>/api/pcap/v1/upload/{filename}</code>  </p>
<p>Method: <code>PUT</code></p>
<table>
<tr>
<th>Parameter</th>
<th>Data Type</th>
<th>Required</th>
<th>Description</th>
</tr>
<tr>
<td>filename</td>
<td>String</td>
<td>Yes</td>
<td>File name</td>
</tr>
</table>

<h3 id="testing-with-curl">Testing with CURL</h3>
<pre><code class="bash">curl 'http://www.threatlab.io/api/pcap/v1/upload/' --upload-file ~/Downloads/sample.pcap
</code></pre>

<h3 id="sample-response-body">Sample response body</h3>
<pre><code class="json">{
    &quot;id&quot;: &quot;f7c14dc9-100d-4a01-8c9e-fe7e40b7c548&quot;
}
</code></pre>

<h2 id="pcap-status">PCAP Status</h2>
<p>PCAP analysis status</p>
<p><code>/api/pcap/v1/{id}/status/</code>    </p>
<p>Method: <code>GET</code></p>
<table>
<tr>
<th>Parameter</th>
<th>Data Type</th>
<th>Required</th>
<th>Description</th>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>Yes</td>
<td>Upload ID</td>
</tr>
</table>

<h3 id="sample-response-body_1">Sample response body</h3>
<pre><code class="json">{
    &quot;status&quot;: &quot;READY&quot;
}
</code></pre>

<h2 id="pcap-detail">PCAP Detail</h2>
<p>PCAP object details.</p>
<p><code>/api/pcap/v1/{id}/</code>  </p>
<p>Method: <code>GET</code></p>
<table>
<tr>
<th>Parameter</th>
<th>Data Type</th>
<th>Required</th>
<th>Description</th>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>Yes</td>
<td>Upload ID</td>
</tr>
</table>

<h3 id="sample-response-body_2">Sample response body</h3>
<pre><code class="json">{
    &quot;id&quot;: &quot;3dbcaa40-cd9b-4fdf-87ec-8cf226e582ff&quot;,
    &quot;status&quot;: &quot;READY&quot;,
    &quot;is_private&quot;: false,
    &quot;created&quot;: &quot;2015-10-07T21:47:51.224781Z&quot;,
    &quot;alerts&quot;: &quot;http://www.threatlab.io/api/pcap/v1/3dbcaa40-cd9b-4fdf-87ec-8cf226e582ff/alerts&quot;,
    &quot;errors&quot;: &quot;http://www.threatlab.io/api/pcap/v1/3dbcaa40-cd9b-4fdf-87ec-8cf226e582ff/errors&quot;
}
</code></pre>

<h2 id="pcap-alerts">PCAP Alerts</h2>
<p>IDS alerts generated during analysis.</p>
<p><code>/api/pcap/v1/{id}/alerts/</code>  </p>
<p>Method: <code>GET</code></p>
<table>
<tr>
<th>Parameter</th>
<th>Data Type</th>
<th>Required</th>
<th>Description</th>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>Yes</td>
<td>Upload ID</td>
</tr>
</table>

<h3 id="sample-response-body_3">Sample response body</h3>
<pre><code class="json">{
    &quot;count&quot;: 7,
    &quot;next&quot;: null,
    &quot;previous&quot;: null,
    &quot;results&quot;: [
        {
            &quot;text&quot;: &quot;ET EXPLOIT Possible Internet Explorer VBscript failure to handle error case information disclosure CVE-2014-6332 Common Function Name&quot;,
            &quot;protocol&quot;: &quot;TCP&quot;,
            &quot;classification&quot;: &quot;Attempted User Privilege Gain&quot;,
            &quot;priority&quot;: 1,
            &quot;src_ip&quot;: &quot;157.193.55.183&quot;,
            &quot;dst_ip&quot;: &quot;192.168.96.10&quot;,
            &quot;src_port&quot;: 80,
            &quot;dst_port&quot;: 1042,
            &quot;tool&quot;: &quot;SURICATA&quot;
        },
        ...
    ]
}
</code></pre>

<h2 id="pcap-errors">PCAP Errors</h2>
<p>Errors logged during analysis.</p>
<p><code>/api/pcap/v1/{id}/errors/</code>    </p>
<p>Method: <code>GET</code></p>
<table>
<tr>
<th>Parameter</th>
<th>Data Type</th>
<th>Required</th>
<th>Description</th>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>Yes</td>
<td>Upload ID</td>
</tr>
</table>

<h3 id="sample-response-body_4">Sample response body</h3>
<pre><code class="json">{
    &quot;count&quot;: 1,
    &quot;next&quot;: null,
    &quot;previous&quot;: null,
    &quot;results&quot;: [
        {
            &quot;error&quot;: &quot;Invalid file format&quot;,
        }
    ]
}
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="./js/jquery-1.10.2.min.js"></script>
        <script src="./js/bootstrap-3.0.3.min.js"></script>
        <script src="./js/highlight.pack.js"></script>
        <script src="./js/base.js"></script>
    </body>
</html>