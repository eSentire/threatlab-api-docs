<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="./img/favicon.ico">

	<title>ThreatLab API Docs</title>

        <link href="./css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="./css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="./css/highlight.css">
        <link href="./css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-575509-32', 'docs.threatlab.io');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href=".">ThreatLab API Docs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="active">
                    <a href=".">Home</a>
                </li>
            
            
            
                <li >
                    <a href="clients/">Clients</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li class="disabled">
                    <a rel="next" >
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="clients/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#threat-lab">Threat Lab</a></li>
        
    
        <li class="main "><a href="#apis">APIs</a></li>
        
            <li><a href="#pcap-upload">PCAP Upload</a></li>
        
            <li><a href="#pcap-status">PCAP Status</a></li>
        
            <li><a href="#pcap-detail">PCAP Detail</a></li>
        
            <li><a href="#pcap-alerts">PCAP Alerts</a></li>
        
            <li><a href="#pcap-errors">PCAP Errors</a></li>
        
    
        <li class="main "><a href="#pagination">Pagination</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="threat-lab">Threat Lab</h1>
<p><a href="http://www.threatlab.io">Threat Lab</a> is a highly-scalable application that uses multiple tools to analyze network packet captures.</p>
<p>Supported tools:</p>
<ul>
<li><a href="https://www.snort.org">Snort</a></li>
<li><a href="http://suricata-ids.org/">Suricata</a></li>
<li><a href="https://bro.org/">Bro IDS</a></li>
</ul>
<p>Detection rules (Snort &amp; Suricata):</p>
<ul>
<li><a href="http://www.emergingthreats.net/open-source/etopen-ruleset">Emerging Threats</a></li>
</ul>
<p>Additional Bro scripts:</p>
<ul>
<li><a href="https://github.com/broala/bro-shellshock">bro-shellshock</a></li>
<li><a href="https://github.com/broala/bro-drwatson">bro-drwatson</a></li>
<li><a href="https://github.com/sethhall/bro-tor">bro-tor</a></li>
<li><a href="https://github.com/sethhall/bro-apt1">bro-apt1</a></li>
<li><a href="https://github.com/reservoirlabs/bro-scripts">bro-scripts</a></li>
<li><a href="https://git://github.com/sheharbano/BotFlex">BotFlex</a></li>
</ul>
<h1 id="apis">APIs</h1>
<blockquote>
<p>You can interact and test the APIs in your browser:</p>
<p><a href="http://www.threatlab.io/api/console/">http://www.threatlab.io/api/console/</a></p>
</blockquote>
<h2 id="pcap-upload">PCAP Upload</h2>
<p>Upload PCAP file and put in queue for analysis.</p>
<p>Response will include an ID that you can use in other calls, such as checking task status and retrieving alerts and errors.</p>
<p><code>/api/pcap/v1/upload/</code>  </p>
<p>Method: <code>PUT</code></p>
<h3 id="parameters">Parameters</h3>
<table>
    <thead>
        <tr>
            <th>Parameter</th>
            <th>Parameter Type</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>file</td>
            <td>body</td>
            <td>file</td>
            <td>Yes</td>
            <td>Pcap file to analyze</td>
        </tr>
            <tr>
            <td>private</td>
            <td>query</td>
            <td>boolean</td>
            <td>No</td>
            <td>Hide results from public</td>
        </tr>
    </tbody>
</table>

<h3 id="error-status-codes">Error Status Codes</h3>
<table>
    <thead>
        <tr>
            <th>HTTP Status Code</th>
            <th>Reason</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>400</td>
            <td>Invalid file format</td>
        </tr>
        <tr>
            <td>200</td>
            <td>Analysis task queued successfully</td>
        </tr>
    </tbody>
</table>

<h3 id="testing-with-curl">Testing with CURL</h3>
<pre><code class="bash">curl 'http://www.threatlab.io/api/pcap/v1/upload' --upload-file ~/Downloads/sample.pcap
</code></pre>

<h3 id="sample-response-body">Sample response body</h3>
<pre><code class="json">{
    &quot;id&quot;: &quot;f7c14dc9-100d-4a01-8c9e-fe7e40b7c548&quot;
}
</code></pre>

<h2 id="pcap-status">PCAP Status</h2>
<p>PCAP analysis status</p>
<p><code>/api/pcap/v1/status/{id}/</code>    </p>
<p>Method: <code>GET</code></p>
<h3 id="parameters_1">Parameters</h3>
<table>
    <thead>
        <tr>
            <th>Parameter</th>
            <th>Parameter Type</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>id</td>
            <td>path</td>
            <td>string</td>
            <td>Yes</td>
            <td>Upload ID</td>
        </tr>
    </tbody>
</table>

<h3 id="error-status-codes_1">Error Status Codes</h3>
<table>
    <thead>
        <tr>
            <th>HTTP Status Code</th>
            <th>Reason</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>404</td>
            <td>ID Not Found</td>
        </tr>
        <tr>
            <td>200</td>
            <td>ID found</td>
        </tr>
    </tbody>
</table>

<h3 id="sample-response-body_1">Sample response body</h3>
<pre><code class="json">{
    &quot;status&quot;: &quot;READY&quot;
}
</code></pre>

<h2 id="pcap-detail">PCAP Detail</h2>
<p>PCAP object details.</p>
<p><code>/api/pcap/v1/detail/{id}/</code>  </p>
<p>Method: <code>GET</code></p>
<h3 id="parameters_2">Parameters</h3>
<table>
    <thead>
        <tr>
            <th>Parameter</th>
            <th>Parameter Type</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>id</td>
            <td>path</td>
            <td>string</td>
            <td>Yes</td>
            <td>Upload ID</td>
        </tr>
    </tbody>
</table>

<h3 id="error-status-codes_2">Error Status Codes</h3>
<table>
    <thead>
        <tr>
            <th>HTTP Status Code</th>
            <th>Reason</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>404</td>
            <td>ID Not Found</td>
        </tr>
        <tr>
            <td>200</td>
            <td>ID found</td>
        </tr>
    </tbody>
</table>

<h3 id="sample-response-body_2">Sample response body</h3>
<pre><code class="json">{
      &quot;id&quot;: &quot;bd508819-79d9-4c5d-b09a-4996a067d066&quot;,
      &quot;status&quot;: &quot;READY&quot;,
      &quot;is_private&quot;: false,
      &quot;created&quot;: &quot;2015-10-17T22:47:40.094372Z&quot;,
      &quot;alerts&quot;: 63,
      &quot;errors&quot;: 3
}
</code></pre>

<h2 id="pcap-alerts">PCAP Alerts</h2>
<p>Return list of all IDS Alerts generated for the PCAP file.</p>
<p><code>/api/pcap/v1/alerts/{id}/</code>  </p>
<p>Method: <code>GET</code></p>
<h3 id="parameters_3">Parameters</h3>
<table>
    <thead>
        <tr>
            <th>Parameter</th>
            <th>Parameter Type</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>id</td>
            <td>path</td>
            <td>string</td>
            <td>Yes</td>
            <td>Upload ID</td>
        </tr>
    </tbody>
</table>

<h3 id="error-status-codes_3">Error Status Codes</h3>
<table>
    <thead>
        <tr>
            <th>HTTP Status Code</th>
            <th>Reason</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>404</td>
            <td>ID Not Found</td>
        </tr>
        <tr>
            <td>200</td>
            <td>ID found</td>
        </tr>
    </tbody>
</table>

<h3 id="sample-response-body_3">Sample response body</h3>
<pre><code class="json">{
    &quot;count&quot;: 7,
    &quot;next&quot;: null,
    &quot;previous&quot;: null,
    &quot;results&quot;: [
        {
            &quot;text&quot;: &quot;ET EXPLOIT Possible Internet Explorer VBscript failure to handle error case information disclosure CVE-2014-6332 Common Function Name&quot;,
            &quot;protocol&quot;: &quot;TCP&quot;,
            &quot;classification&quot;: &quot;Attempted User Privilege Gain&quot;,
            &quot;priority&quot;: 1,
            &quot;src_ip&quot;: &quot;157.193.55.183&quot;,
            &quot;dst_ip&quot;: &quot;192.168.96.10&quot;,
            &quot;src_port&quot;: 80,
            &quot;dst_port&quot;: 1042,
            &quot;tool&quot;: &quot;SURICATA&quot;
        },
        ...
    ]
}
</code></pre>

<h2 id="pcap-errors">PCAP Errors</h2>
<p>Errors logged during analysis.</p>
<p><code>/api/pcap/v1/errors/{id}/</code>    </p>
<p>Method: <code>GET</code></p>
<h3 id="parameters_4">Parameters</h3>
<table>
    <thead>
        <tr>
            <th>Parameter</th>
            <th>Parameter Type</th>
            <th>Data Type</th>
            <th>Required</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>id</td>
            <td>path</td>
            <td>string</td>
            <td>Yes</td>
            <td>Upload ID</td>
        </tr>
    </tbody>
</table>

<h3 id="error-status-codes_4">Error Status Codes</h3>
<table>
    <thead>
        <tr>
            <th>HTTP Status Code</th>
            <th>Reason</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>404</td>
            <td>ID Not Found</td>
        </tr>
        <tr>
            <td>200</td>
            <td>ID found</td>
        </tr>
    </tbody>
</table>

<h3 id="sample-response-body_4">Sample response body</h3>
<pre><code class="json">{
    &quot;count&quot;: 2,
    &quot;next&quot;: null,
    &quot;previous&quot;: null,
    &quot;results&quot;: [
        {
            &quot;error&quot;: &quot;Invalid file format&quot;,
            &quot;tool&quot;: &quot;SNORT&quot;,
            &quot;pcap&quot;: &quot;http://www.threatlab.io/api/pcap/v1/3dbcaa40-cd9b-4fdf-87ec-8cf226e582ff&quot;
        },
        ...
    ]
}
</code></pre>

<h1 id="pagination">Pagination</h1>
<p>ThreatLab API uses "Limit-Offset" pagination.
The client includes both a "limit" and an "offset" query parameter. 
The limit indicates the maximum number of items to return. The default limit size is 10. 
The offset indicates the starting position of the query in relation to the complete set of unpaginated items.</p>
<p>Request example:</p>
<pre><code class="curl">GET http://www.threatlab.io/api/pcap/v1/alerts/3dbcaa40-cd9b-4fdf-87ec-8cf226e582ff/?limit=5&amp;offset=5
</code></pre>

<p>Response:</p>
<pre><code class="json">{
    &quot;count&quot;: 10,
    &quot;next&quot;: null,
    &quot;previous&quot;: &quot;http://www.threatlab.io/api/pcap/v1/alerts/3dbcaa40-cd9b-4fdf-87ec-8cf226e582ff/?limit=5&quot;,
    &quot;results&quot;: [
        ...
    ]
}
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="./js/jquery-1.10.2.min.js"></script>
        <script src="./js/bootstrap-3.0.3.min.js"></script>
        <script src="./js/highlight.pack.js"></script>
        <script src="./js/base.js"></script>
    </body>
</html>